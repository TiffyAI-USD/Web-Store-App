<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Café Website Printer</title>
  <style>
    .editor {background:#000;padding:30px;color:#eee;font-family:sans-serif;max-width:1000px;margin:auto}
    .editor h1 {color:#d4a373;text-align:center}
    .editor h2 {color:#d4a373;margin:40px 0 20px}
    .editor label {display:block;margin:15px 0 5px;font-weight:bold;color:#d4a373}
    .editor input {width:100%;padding:12px;background:#222;color:#fff;border:1px solid #444;border-radius:8px}
    .product {background:#111;padding:20px;margin:15px 0;border-radius:10px}
    .generate-btn {background:#d4a373;color:#000;padding:20px 60px;font-size:1.6rem;border:none;border-radius:50px;margin:60px auto;display:block;font-weight:bold;cursor:pointer}
    .generate-btn:hover {transform:scale(1.05)}
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

  <!-- EDITOR PANEL -->
  <div class="editor">
    <h1>CAFÉ WEBSITE PRINTER</h1>
    <p style="text-align:center;margin-bottom:40px">Change business info and every product → Click Generate to download clean site</p>

    <h2>Business Info</h2>
    <label>Café Name</label><input id="cafeName" value="PAPA RON'S CAFÉ">
    <label>Tagline</label><input id="tagline" value="FOOD • GOOD MUSIC">
    <label>Logo Image URL</label><input id="logoUrl" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/logo.jpg">
    <label>Banner Image URL</label><input id="bannerUrl" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/banner.jpg">
    <label>Footer Location</label><input id="footerLocation" value="COFFEE BAY, MTHATHA">
    <label>Copyright Year</label><input id="copyrightYear" value="2025">
    <label>WhatsApp Number</label><input id="whatsapp" value="+27660660088">

    <h2>Products</h2>

    <!-- PIZZAS -->
    <h3>PIZZAS</h3>
    <div class="product">
      <label>Name</label><input data-group="pizzas" data-index="0" data-field="name" value="SOMETHING MEATY">
      <label>Price (blank for custom)</label><input data-group="pizzas" data-index="0" data-field="price" value="135">
      <label>Description</label><input data-group="pizzas" data-index="0" data-field="desc" value="Creamy chicken, bacon, mushrooms, cheese">
      <label>Image URL</label><input data-group="pizzas" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/pizza.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="pizzas" data-index="1" data-field="name" value="HAWAIIAN">
      <label>Price</label><input data-group="pizzas" data-index="1" data-field="price" value="135">
      <label>Description</label><input data-group="pizzas" data-index="1" data-field="desc" value="Ham, pineapple, cheese">
      <label>Image URL</label><input data-group="pizzas" data-index="1" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/pizza1.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="pizzas" data-index="2" data-field="name" value="FLAMING SPARE RIB PIZZA">
      <label>Price</label><input data-group="pizzas" data-index="2" data-field="price" value="150">
      <label>Description</label><input data-group="pizzas" data-index="2" data-field="desc" value="Ribs on pizza base with cheese">
      <label>Image URL</label><input data-group="pizzas" data-index="2" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/ribpizza.jpg">
    </div>

    <!-- BURGERS -->
    <h3>BURGERS</h3>
    <div class="product">
      <label>Name</label><input data-group="burgers" data-index="0" data-field="name" value="CHEESE BURGER">
      <label>Price</label><input data-group="burgers" data-index="0" data-field="price" value="120">
      <label>Description</label><input data-group="burgers" data-index="0" data-field="desc" value="Served with side chips">
      <label>Image URL</label><input data-group="burgers" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/burger.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="burgers" data-index="1" data-field="name" value="CHEESY STRIPS">
      <label>Price</label><input data-group="burgers" data-index="1" data-field="price" value="50">
      <label>Description</label><input data-group="burgers" data-index="1" data-field="desc" value="5 x Cheesy Strips, served with dip">
      <label>Image URL</label><input data-group="burgers" data-index="1" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/strip.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="burgers" data-index="2" data-field="name" value="BOERIE ROLL">
      <label>Price</label><input data-group="burgers" data-index="2" data-field="price" value="50">
      <label>Description</label><input data-group="burgers" data-index="2" data-field="desc" value="Boerie with chips or salad">
      <label>Image URL</label><input data-group="burgers" data-index="2" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/boerie.jpeg">
    </div>

    <!-- GRILL -->
    <h3>GRILL</h3>
    <div class="product">
      <label>Name</label><input data-group="grill" data-index="0" data-field="name" value="RUMP STEAK">
      <label>Price</label><input data-group="grill" data-index="0" data-field="price" value="160">
      <label>Description</label><input data-group="grill" data-index="0" data-field="desc" value="Loaded with mushroom sauce & chips">
      <label>Image URL</label><input data-group="grill" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/rump.jpeg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="grill" data-index="1" data-field="name" value="RIB RACK">
      <label>Price</label><input data-group="grill" data-index="1" data-field="price" value="200">
      <label>Description</label><input data-group="grill" data-index="1" data-field="desc" value="Full rack with chips">
      <label>Image URL</label><input data-group="grill" data-index="1" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/ribs.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="grill" data-index="2" data-field="name" value="SCHNITZEL">
      <label>Price</label><input data-group="grill" data-index="2" data-field="price" value="120">
      <label>Description</label><input data-group="grill" data-index="2" data-field="desc" value="Chicken schnitzel with chips & sauce">
      <label>Image URL</label><input data-group="grill" data-index="2" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/snitsel.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="grill" data-index="3" data-field="name" value="PREGO ROLL">
      <label>Price</label><input data-group="grill" data-index="3" data-field="price" value="50">
      <label>Description</label><input data-group="grill" data-index="3" data-field="desc" value="Peri-peri steak roll with chips">
      <label>Image URL</label><input data-group="grill" data-index="3" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/prego.jpg">
    </div>

    <!-- SNACKS & PLATTERS -->
    <h3>SNACKS & PLATTERS</h3>
    <div class="product">
      <label>Name</label><input data-group="snacks" data-index="0" data-field="name" value="MUNCHIE PLATTER">
      <label>Price</label><input data-group="snacks" data-index="0" data-field="price" value="350">
      <label>Description</label><input data-group="snacks" data-index="0" data-field="desc" value="Full varieties of munchies">
      <label>Image URL</label><input data-group="snacks" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/platters.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="snacks" data-index="1" data-field="name" value="CHEESY POPS">
      <label>Price</label><input data-group="snacks" data-index="1" data-field="price" value="50">
      <label>Description</label><input data-group="snacks" data-index="1" data-field="desc" value="Cheesy pops served with dip">
      <label>Image URL</label><input data-group="snacks" data-index="1" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/pops.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="snacks" data-index="2" data-field="name" value="CHICKEN PERI NACHO">
      <label>Price</label><input data-group="snacks" data-index="2" data-field="price" value="160">
      <label>Description</label><input data-group="snacks" data-index="2" data-field="desc" value="Peri-peri chicken, nachos & cheese">
      <label>Image URL</label><input data-group="snacks" data-index="2" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/nantcho.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="snacks" data-index="3" data-field="name" value="WINGLETS">
      <label>Price (blank for custom)</label><input data-group="snacks" data-index="3" data-field="price" value="">
      <label>Description</label><input data-group="snacks" data-index="3" data-field="desc" value="5 for R60 • 10 for R100 — served with dip">
      <label>Image URL</label><input data-group="snacks" data-index="3" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/buffelowings.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="snacks" data-index="4" data-field="name" value="PLATTER">
      <label>Price</label><input data-group="snacks" data-index="4" data-field="price" value="350">
      <label>Description</label><input data-group="snacks" data-index="4" data-field="desc" value="Mixed meat platter for 2">
      <label>Image URL</label><input data-group="snacks" data-index="4" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/platter.jpg">
    </div>

    <!-- BREAKFAST -->
    <h3>BREAKFAST</h3>
    <div class="product">
      <label>Name</label><input data-group="breakfast" data-index="0" data-field="name" value="BREAKFAST">
      <label>Price</label><input data-group="breakfast" data-index="0" data-field="price" value="80">
      <label>Description</label><input data-group="breakfast" data-index="0" data-field="desc" value="Eggs, bacon, toast, coffee — served 8–11 AM">
      <label>Image URL</label><input data-group="breakfast" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/breakfast.jpg">
    </div>

    <!-- SIDES -->
    <h3>SIDES</h3>
    <div class="product">
      <label>Name</label><input data-group="sides" data-index="0" data-field="name" value="SIDE CHIPS">
      <label>Price</label><input data-group="sides" data-index="0" data-field="price" value="20">
      <label>Description</label><input data-group="sides" data-index="0" data-field="desc" value="Crispy golden chips">
      <label>Image URL</label><input data-group="sides" data-index="0" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/chips.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="sides" data-index="1" data-field="name" value="SIDE SALAD">
      <label>Price</label><input data-group="sides" data-index="1" data-field="price" value="20">
      <label>Description</label><input data-group="sides" data-index="1" data-field="desc" value="Fresh garden salad">
      <label>Image URL</label><input data-group="sides" data-index="1" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/salad.jpg">
    </div>
    <div class="product">
      <label>Name</label><input data-group="sides" data-index="2" data-field="name" value="GREEK SALAD">
      <label>Price</label><input data-group="sides" data-index="2" data-field="price" value="20">
      <label>Description</label><input data-group="sides" data-index="2" data-field="desc" value="Feta, olives, tomatoes & dressing">
      <label>Image URL</label><input data-group="sides" data-index="2" data-field="img" value="https://tiffyai-usd.github.io/Papa_Rons_Cafe/greeksalad.jpg">
    </div>

    <button class="generate-btn" onclick="generateAndDownload()">GENERATE & DOWNLOAD NEW SITE</button>
  </div>

  <!-- Your original Papa Ron's Café site starts here -->
  <header>
    <img src="https://tiffyai-usd.github.io/Papa_Rons_Cafe/logo.jpg" alt="Papa Ron's Logo" class="logo">
    <h1>PAPA RON'S CAFÉ</h1>
    <p class="tagline">FOOD • GOOD MUSIC</p>

    <div class="menu-wrap" style="margin-top:18px;">
      <button id="mainBtn" class="gold-flame-btn" aria-haspopup="true" aria-expanded="false" title="Menu ORDER NOW">
        <span class="menu-icon" aria-hidden="true">
          <span class="a"></span><span class="b"></span><span class="c"></span>
        </span>
        <span style="margin-left:8px;">MENU ORDER NOW</span>
      </button>

      <div id="actionMenu" class="action-menu" role="menu" aria-hidden="true">
        <a href="#menu" id="scrollToMenu" class="action-item" role="menuitem">Browse Menu</a>
        <a href="#" id="openMenu" class="action-item" role="menuitem">View Full Menu</a>
        <a href="https://tiffyai-usd.github.io/Papa_Rons_Cafe/menu1.pdf" class="action-item" download role="menuitem">Download Menu PDF</a>
      </div>
    </div>
  </header>

  <div id="menuLightbox" class="lightbox" aria-hidden="true">
    <div class="box">
      <div class="close" id="closeMenu" title="Close">X</div>
      <img src="https://tiffyai-usd.github.io/Papa_Rons_Cafe/menu1.jpeg" alt="Full Menu">
      <div style="margin-top:1rem; color:#d4a373; font-family:'Bebas Neue',cursive; font-size:1.05rem;">
        WhatsApp your order: <a href="https://wa.me/+27660660088" style="color:#25D366;">+27 66 066 0088</a>
      </div>
    </div>
  </div>

  <section id="menu">
    <h2 class="section-title">PIZZAS</h2>
    <div class="menu-grid" id="pizzasGrid"></div>

    <h2 class="section-title">BURGERS</h2>
    <div class="menu-grid" id="burgersGrid"></div>

    <h2 class="section-title">GRILL</h2>
    <div class="menu-grid" id="grillGrid"></div>

    <h2 class="section-title">SNACKS & PLATTERS</h2>
    <div class="menu-grid" id="snacksGrid"></div>

    <h2 class="section-title">BREAKFAST</h2>
    <div class="menu-grid" id="breakfastGrid"></div>

    <h2 class="section-title">SIDES</h2>
    <div class="menu-grid" id="sidesGrid"></div>
  </section>

  <footer>
    <p>© 2025 PAPA RON'S CAFÉ • COFFEE BAY, MTHATHA</p>
    <p>WHATSAPP: <a href="https://wa.me/+27660660088">+27 66 066 0088</a></p>
    <p style="margin-top:1rem; font-size:0.8rem; opacity:0.8;">We’ll call you within 5 mins to confirm & take payment.</p>
  </footer>

  <script>
    const pizzas = [
      { name: "SOMETHING MEATY", price: 135, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/pizza.jpg", desc:"Creamy chicken, bacon, mushrooms, cheese" },
      { name: "HAWAIIAN", price: 135, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/pizza1.jpg", desc:"Ham, pineapple, cheese" },
      { name: "FLAMING SPARE RIB PIZZA", price: 150, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/ribpizza.jpg", desc:"Ribs on pizza base with cheese" }
    ];

    const burgers = [
      { name: "CHEESE BURGER", price:120, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/burger.jpg", desc:"Served with side chips" },
      { name: "CHEESY STRIPS", price:50, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/strip.jpg", desc:"5 x Cheesy Strips, served with dip" },
      { name: "BOERIE ROLL", price:50, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/boerie.jpeg", desc:"Boerie with chips or salad" }
    ];

    const grill = [
      { name: "RUMP STEAK", price:160, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/rump.jpeg", desc:"Loaded with mushroom sauce & chips" },
      { name: "RIB RACK", price:200, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/ribs.jpg", desc:"Full rack with chips" },
      { name: "SCHNITZEL", price:120, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/snitsel.jpg", desc:"Chicken schnitzel with chips & sauce" },
      { name: "PREGO ROLL", price:50, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/prego.jpg", desc:"Peri-peri steak roll with chips" }
    ];

    const snacks = [
      { name:"MUNCHIE PLATTER", price:350, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/platters.jpg", desc:"Full varieties of munchies" },
      { name:"CHEESY POPS", price:50, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/pops.jpg", desc:"Cheesy pops served with dip" },
      { name:"CHICKEN PERI NACHO", price:160, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/nantcho.jpg", desc:"Peri-peri chicken, nachos & cheese" },
      { name:"WINGLETS", price:null, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/buffelowings.jpg", desc:"5 for R60 • 10 for R100 — served with dip" },
      { name:"PLATTER", price:350, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/platter.jpg", desc:"Mixed meat platter for 2" }
    ];

    const breakfast = [
      { name:"BREAKFAST", price:80, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/breakfast.jpg", desc:"Eggs, bacon, toast, coffee — served 8–11 AM" }
    ];

    const sides = [
      { name:"SIDE CHIPS", price:20, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/chips.jpg", desc:"Crispy golden chips" },
      { name:"SIDE SALAD", price:20, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/salad.jpg", desc:"Fresh garden salad" },
      { name:"GREEK SALAD", price:20, img:"https://tiffyai-usd.github.io/Papa_Rons_Cafe/greeksalad.jpg", desc:"Feta, olives, tomatoes & dressing" }
    ];

    function createMenuCard(item, key) {
      const div = document.createElement('div');
      div.className = 'menu-item';
      const priceHtml = item.price === null ? `<div class="price">5 for R60 · 10 for R100</div>` : `<div class="price">R${item.price}.00</div>`;
      div.innerHTML = `
        <img src="\( {item.img}" alt=" \){item.name}" onerror="this.src='https://via.placeholder.com/600x400/333/ccc?text=Image+Missing'">
        <div class="card">
          <h3>${item.name}</h3>
          <p class="desc">${item.desc}</p>
          ${priceHtml}
          <div class="row">
            <a class="drinks-link" href="https://tiffyai-usd.github.io/Papa_Rons_Cafe/drinks-menu.html" target="_blank" rel="noopener">ADD DRINKS</a>
            <div class="qty-controls">
              <div class="qty-btn" data-key="${key}" data-change="-1">−</div>
              <div class="qty-num" id="qty-${key}">0</div>
              <div class="qty-btn" data-key="${key}" data-change="1">+</div>
            </div>
          </div>
        </div>
      `;
      return div;
    }

    function renderGroup(items, containerId) {
      const grid = document.getElementById(containerId);
      grid.innerHTML = '';
      items.forEach((it, i) => {
        const key = `\( {containerId}- \){i}`;
        const card = createMenuCard(it, key);
        grid.appendChild(card);
      });
    }

    renderGroup(pizzas, 'pizzasGrid');
    renderGroup(burgers, 'burgersGrid');
    renderGroup(grill, 'grillGrid');
    renderGroup(snacks, 'snacksGrid');
    renderGroup(breakfast, 'breakfastGrid');
    renderGroup(sides, 'sidesGrid');

    const qtyState = {};

    document.addEventListener('click', (e) => {
      const el = e.target.closest('.qty-btn');
      if (!el) return;
      const key = el.dataset.key;
      const change = parseInt(el.dataset.change, 10);
      updateQty(key, change);
    });

    function updateQty(key, change) {
      const el = document.getElementById(`qty-${key}`);
      if (!el) return;
      let val = parseInt(el.textContent, 10) || 0;
      val += change;
      if (val < 0) val = 0;
      el.textContent = val;
      qtyState[key] = val;
      updateOrderButton(); 
    }

    function updateOrderButton() {
      const all = document.querySelectorAll('[id^="qty-"]');
      let total = 0;
      all.forEach(n => {
        const v = parseInt(n.textContent, 10);
        if (!isNaN(v)) total += v;
      });

      let btn = document.getElementById('bottomOrderBtn');
      if (!btn) {
        btn = document.createElement('a');
        btn.id = 'bottomOrderBtn';
        btn.className = 'gold-flame-btn';
        btn.style.position = 'fixed';
        btn.style.right = '16px';
        btn.style.bottom = '22px';
        btn.style.zIndex = '999';
        btn.style.padding = '12px 18px';
        btn.textContent = 'ORDER NOW';
        document.body.appendChild(btn);
      }
      btn.style.display = total > 0 ? 'inline-flex' : 'none';

      let message = "Hi Papa Ron's! I'd like to order:\n\n";
      const groups = [
        {items:pizzas,id:'pizzasGrid'},
        {items:burgers,id:'burgersGrid'},
        {items:grill,id:'grillGrid'},
        {items:snacks,id:'snacksGrid'},
        {items:breakfast,id:'breakfastGrid'},
        {items:sides,id:'sidesGrid'}
      ];
      groups.forEach(g => {
        g.items.forEach((it,i) => {
          const key = `\( {g.id}- \){i}`;
          const qEl = document.getElementById(`qty-${key}`);
          if (qEl) {
            const q = parseInt(qEl.textContent,10) || 0;
            if (q>0) {
              if (it.price === null) {
                message += `\( {q} x \){it.name} - see menu for 5/10 prices\n`;
              } else {
                message += `\( {q} x \){it.name} - R${it.price}.00\n`;
              }
            }
          }
        });
      });
      message += `\nThank you!`;
      const encoded = encodeURIComponent(message);
      btn.href = "https://wa.me/+27660660088?text=" + encoded;
    }

    updateOrderButton();

    const mainBtn = document.getElementById('mainBtn');
    const actionMenu = document.getElementById('actionMenu');
    const scrollToMenu = document.getElementById('scrollToMenu');

    mainBtn.addEventListener('click', (e) => {
      const open = actionMenu.classList.toggle('show');
      mainBtn.classList.toggle('open', open);
      mainBtn.setAttribute('aria-expanded', String(open));
      actionMenu.setAttribute('aria-hidden', String(!open));
      e.stopPropagation();
    });

    document.addEventListener('click', (e) => {
      if (!mainBtn.contains(e.target) && !actionMenu.contains(e.target)) {
        actionMenu.classList.remove('show');
        mainBtn.classList.remove('open');
        mainBtn.setAttribute('aria-expanded','false');
        actionMenu.setAttribute('aria-hidden','true');
      }
    });

    scrollToMenu.addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('menu').scrollIntoView({ behavior:'smooth' });
      actionMenu.classList.remove('show');
      mainBtn.classList.remove('open');
    });

    const openMenu = document.getElementById('openMenu');
    const menuLightbox = document.getElementById('menuLightbox');
    const closeMenu = document.getElementById('closeMenu');

    openMenu.addEventListener('click', (e) => {
      e.preventDefault();
      menuLightbox.style.display = 'flex';
      menuLightbox.setAttribute('aria-hidden','false');
      actionMenu.classList.remove('show');
      mainBtn.classList.remove('open');
    });
    closeMenu.addEventListener('click', () => {
      menuLightbox.style.display = 'none';
      menuLightbox.setAttribute('aria-hidden','true');
    });
    window.addEventListener('click', (e) => {
      if (e.target === menuLightbox) {
        menuLightbox.style.display = 'none';
        menuLightbox.setAttribute('aria-hidden','true');
      }
    });

    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        menuLightbox.style.display = 'none';
        menuLightbox.setAttribute('aria-hidden','true');
        actionMenu.classList.remove('show');
        mainBtn.classList.remove('open');
      }
    });

    document.addEventListener('error', function(e){
      const el = e.target;
      if (el.tagName && el.tagName.toLowerCase() === 'img') {
        el.src = 'https://via.placeholder.com/600x400/333/ccc?text=Image+Missing';
      }
    }, true);

    // FIXED GENERATE FUNCTION
    function generateAndDownload() {
      let html = document.documentElement.outerHTML;

      const cafeName = document.getElementById('cafeName').value.trim().toUpperCase() || 'CAFÉ';
      const tagline = document.getElementById('tagline').value.trim().toUpperCase() || 'FOOD • GOOD MUSIC';
      const logo = document.getElementById('logoUrl').value.trim();
      const banner = document.getElementById('bannerUrl').value.trim();
      const location = document.getElementById('footerLocation').value.trim();
      const year = document.getElementById('copyrightYear').value.trim();
      const wa = document.getElementById('whatsapp').value.replace(/[^0-9+]/g, '');

      const items = {pizzas: [], burgers: [], grill: [], snacks: [], breakfast: [], sides: []};
      document.querySelectorAll('input[data-group]').forEach(inp => {
        const group = inp.dataset.group;
        const index = parseInt(inp.dataset.index);
        const field = inp.dataset.field;
        if (!items[group][index]) items[group][index] = {};
        items[group][index][field] = (field === 'price' && inp.value.trim() === '') ? null : inp.value.trim();
      });

      const newData = `
    const pizzas = ${JSON.stringify(items.pizzas.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};
    const burgers = ${JSON.stringify(items.burgers.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};
    const grill = ${JSON.stringify(items.grill.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};
    const snacks = ${JSON.stringify(items.snacks.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};
    const breakfast = ${JSON.stringify(items.breakfast.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};
    const sides = ${JSON.stringify(items.sides.map(i => ({name:i.name||'',price:i.price===null?null:+i.price||null,img:i.img||'',desc:i.desc||''})),null,2)};`;

      html = html
        .replace(/PAPA RON'S CAFÉ/g, cafeName)
        .replace(/FOOD • GOOD MUSIC/g, tagline)
        .replace(/https:\/\/tiffyai-usd\.github\.io\/Papa_Rons_Cafe\/logo\.jpg/g, logo)
        .replace(/url\('https:\/\/tiffyai-usd\.github\.io\/Papa_Rons_Cafe\/banner\.jpg'\)/g, `url('${banner}')`)
        .replace(/COFFEE BAY, MTHATHA/g, location)
        .replace(/2025/g, year)
        .replace(/\+27660660088/g, wa)
        .replace(/WhatsApp your order:[^<]*<a[^>]*>[^<]*<\/a>/g, `WhatsApp your order: <a href="https://wa.me/\( {wa}" style="color:#25D366;"> \){wa.replace('+','')}</a>`)
        .replace(/https:\/\/wa\.me\/\+27660660088/g, `https://wa.me/${wa}`)
        .replace(/const pizzas = \[[\s\S]*?\];[\s\S]*?const sides = \[[\s\S]*?\];/, newData)
        .replace(/<div class="editor">[\s\S]*?<\/div>/, '');  // <-- THIS LINE REMOVES THE EDITOR PANEL FROM THE DOWNLOADED FILE

      const blob = new Blob([html], {type: 'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'my-new-cafe-site.html';
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
